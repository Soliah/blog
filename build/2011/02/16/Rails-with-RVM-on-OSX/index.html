<!DOCTYPE html>
<html lang='en'>
  <head>
    <meta charset='UTF-8'>
    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no' name='viewport'>
    <link href="/stylesheets/application.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="/stylesheets/syntax.css" media="screen" rel="stylesheet" type="text/css" />
    <link href='//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css' rel='stylesheet'>
  </head>
  <body>
    <div id='bar'></div>
    <div class='container'>
      <header>
        <div class='col-xs-7 col-md-6 nav'>
          <a href='/'>
            <span id="first">yield</span> <span id="second">@chow</span>
          </a>
        </div>
        <div class='col-xs-5 col-md-6 social'>
          <a href='mailto:chris@chowie.net'>
            <i class='icon-envelope-alt'></i>
          </a>
          <a href='https://twitter.com/Soliah'>
            <i class='icon-twitter'></i>
          </a>
          <a href='https://github.com/Soliah'>
            <i class='icon-github'></i>
          </a>
          <a href='http://stackoverflow.com/users/140578/soliah'>
            <i class='icon-stackexchange'></i>
          </a>
        </div>
      </header>
      <section class='content'>
        <div class='row'>
          <div class='col-md-12'>
            <div class='post'>
              <h1>Rails with RVM on OSX</h1>
              <time>Feb 16, 2011</time>
              <p>I realise that there are plenty of tutorials online that show how to get Rails setup on OSX. A lot of them are very brief and don&rsquo;t explain much about what&rsquo;s going on.  I&rsquo;ve decided to write a guide that will flesh out your typical Rails setup guide.</p>
              
              <p>Almost all of the stuff performed in this guide is done inside Terminal.app. Note that I will assume knowledge of the command line and basic nix commands.</p>
              
              <h2>Apple Developer Tools</h2>
              
              <p>The Apple Developer tools are required to get a working development environment. This can be downloaded and installed from <a href="http://connect.apple.com/">ADC</a>. An ADC (free) account is required to download the tools (which is quite a large download @ ~3.5GB).</p>
              
              <h2>Homebrew</h2>
              
              <p>Before even getting to Ruby or Rails we need to install the git version control system. This is required by RVM. There are a <a href="http://help.github.com/mac-git-installation/">number of ways</a> of installing git on OSX, though I recommend using a package manager like <a href="http://mxcl.github.com/homebrew">Homebrew</a> or <a href="http://www.macports.org/">Macports</a>. I went with Homebrew. Install Homebrew by following the instructions on <a href="https://github.com/mxcl/homebrew/wiki/installation">Github</a>. I chose to install it into <code>/usr/local</code> and haven&rsquo;t had any negative side effects after taking ownership of it. </p>
              
              <p>Once Homebrew is installed run the following command to install <code>git</code>:</p>
              <pre class="highlight text">$ brew install git</pre>
              <p>Might as well install a few other packages as well:</p>
              <pre class="highlight text">$ brew install wget sqlite postgresql</pre>
              <p>Then run the following to initialise the postgres database.</p>
              <pre class="highlight text">$ initdb /usr/local/var/postgres</pre>
              <h2>Ruby Version Manager</h2>
              
              <p>RVM provides the ability to switch between multiple versions of Ruby as well as providing an added feature called gemsets. Gemsets allow you to create specific sets of gems, preventing you from polluting your gem environment and also preventing gems from conflicting (eg. Rails 2 and Rails 3 can be placed in separate gemsets).</p>
              
              <p>Install RVM in the recommended fashion:</p>
              <pre class="highlight text">$ bash &lt; &lt;( curl http://rvm.beginrescueend.com/releases/rvm-install-head )</pre>
              <p>The following then needs to be placed after any <code>$PATH</code> declarations in your shell&rsquo;s RC file.</p>
              <pre class="highlight text">[[ -s &quot;$HOME/.rvm/scripts/rvm&quot; ]] &amp;&amp; . &quot;$HOME/.rvm/scripts/rvm&quot;</pre>
              <p>Now either close and reopen Terminal or <code>source</code> your shell&rsquo;s rc file. In my case that was my <code>.zshrc</code> file. Once this is done <code>rvm notes</code> should work and display some notes regarding RVM. We can now use RVM to get the appropriate versions of Ruby. RVM will install Ruby to <code>~/.rvm</code>, providing a nice sandboxed Ruby install for development.</p>
              
              <p>Create a <code>.gemrc</code> file to prevent the rdocs from being installed with gems as I never use them.</p>
              <pre class="highlight text">$ echo &quot;gem: --no-ri --no-rdoc&quot; &gt;&gt; .gemrc</pre>
              <p>Then install Ruby 1.9.2:</p>
              <pre class="highlight text">$ rvm install 1.9.2</pre>
              <p>RVM will download the Ruby source, compile it and install it to <code>~/.rvm/rubies/ruby-1.9.2-pXXX</code>. Switch to the newly installed version by running:</p>
              <pre class="highlight text">$ rvm use 1.9.2&#x000A;$ ruby -v&#x000A;ruby 1.9.2p136 (2010-12-25 revision 30365) [x86_64-darwin10.6.0]</pre>
              <p>We can set a default version to use by running:</p>
              <pre class="highlight text">rvm --default use 1.9.2</pre>
              <p>Switching back to the system Ruby by using:</p>
              <pre class="highlight text">$ rvm use system&#x000A;Now using system ruby.</pre>
              <h2>Gems and gemsets</h2>
              
              <p>Gems can be installed in the standard manner using the <code>gem</code> command. Make sure not to use <code>sudo</code> as this will use the system Ruby and install gems into <code>/Library/Ruby/Gems/1.8</code>.</p>
              
              <p>As mentioned earlier, RVM allows for things called gemsets. Gemsets allows for multiple groups of gems on a per Ruby basis. RVM also provides a global gemset. This is set of gems that is available to all <em>other</em> gemsets in a particular Ruby. Gems that are appropriate for the global gemset are gems like wirble, rake, bundler and rdoc. Let&rsquo;s create the global gemset and install these gems in it.</p>
              
              <p>First make sure the gem environment is correctly setup:</p>
              <pre class="highlight text">$ gem env | sed &#39;10,12!d&#39;&#x000A;- GEM PATHS:&#x000A; - /Users/Soliah/.rvm/gems/ruby-1.9.2-p136&#x000A; - /Users/Soliah/.rvm/gems/ruby-1.9.2-p136@global</pre>
              <p>This is the output when no particular gemset is chosen. Note that there are two paths that are searched for gems. Let&rsquo;s switch to the global gemset and install some gems.</p>
              <pre class="highlight text">$ rvm gemset use global&#x000A;Now using gemset &#39;global&#39;&#x000A;$ gem install wirble bundler rake rdoc</pre>
              <p>If we run <code>gem list</code>:</p>
              <pre class="highlight text">*** LOCAL GEMS ***&#x000A;&#x000A;bundler (1.0.10)&#x000A;rake (0.8.7)&#x000A;rdoc (3.5.3)&#x000A;wirble (0.1.3)</pre>
              <p>Now, no matter what gemset we are using those four gems will be available. Let&rsquo;s make a rails3 gemset.</p>
              <pre class="highlight text">$ rvm gemset use rails3&#x000A;$ gem install rails</pre>
              <p>This will install the 20 or so gems that rails depends on in the rails3 gemset. If we look at the gem path we can see that the global gemset is always there. This is how the global gemset works.</p>
              <pre class="highlight text">$ gem env | sed &#39;10,12!d&#39;&#x000A;- GEM PATHS:&#x000A; - /Users/Soliah/.rvm/gems/ruby-1.9.2-p136@rails3&#x000A; - /Users/Soliah/.rvm/gems/ruby-1.9.2-p136@global</pre>
              <p>To make a particular gemset a default for a particular directory, RVM requires a <code>.rvmrc</code> file in that directory. To create one we can use the following command:</p>
              <pre class="highlight text">rvm use 1.9.2@rails3 --rvmrc</pre>
              <p>The next time you switch to this directory RVM will prompt you to confirm if the <code>.rvmrc</code> is to be trusted or not. Just follow the prompts to trust it. From then on if you switch to this directory, RVM will automatically switch to the rails3 gemset.</p>
              
              <p>For other gemset commands (creating, deleting, listing etc) refer to the RVM manual <a href="http://rvm.beginrescueend.com/gemsets/">here</a>.</p>
              
              <h2>Closing</h2>
              
              <p>If I missed anything please let me know.</p>
              <hr>
              <div id='disqus_thread'></div>
              <noscript>
                <a href='http://chowie.disqus.com/?url=ref'>
                  View the discussion thread.
                </a>
              </noscript>
            </div>
          </div>
        </div>
      </section>
    </div>
    <footer class='container'>
      <div class='row'>
        <div class='col-md-12'>
          &copy; 2011-13 Christopher Chow. Powered by
          <a href='http://middlemanapp.com'>Middleman.</a>
          Hosted on
          <a href='http://http://pages.github.com'>GitHub Pages</a>
        </div>
      </div>
    </footer>
  </body>
  <script src="/javascripts/application.js" type="text/javascript"></script>
  <script src="http://disqus.com/forums/chowie/embed.js" type="text/javascript"></script>
</html>

